---
title: "Week_5 Day_2 Homework_mahri"
output: html_notebook
---
## Introduction to ggplot2 homework

**Question 1.**
Load in the libraries you need, and look at the backpack data. Take note of 
variable names and dimensions.

```{r}
library(tidyverse)
library(ggthemes)
```

```{r}
backpack <- CodeClanData::backpack
backpack
dim(backpack)
glimpse(backpack)
names(backpack)
```

The dataset "backpack" has 100 rows and 9 columns with column names: 

* backpack_weight - ranging from 2 - 35
* body_weight - ranging from 105 - 270 (probably lbs)
* ratio - backpack weight divided by body weight
* back_problems - a numeric column where 0 = "no back problems" and 1 = "back 
problems"
* major - the individual's University Major
* year - ranging from 0 - 6
* sex - "male" or "female"
* status - "U" or "G"
* units - ranging from 0 - 20



**Question 2.**
What is the distribution of backpack weights that students are carrying? Choose 
an appropriate graph to show the distribution.

**Answer** 
There is one outlying student carrying a 35kg bag (I would hope that the weight 
of backpacks is not measured in kg's or that this was a mistake). Most of the 
students are carring bags of between 5 and 15kgs with the lightest bag weighing 
2kg.

```{r}
backpack_weights <- backpack %>% 
  group_by(backpack_weight) %>% 
  summarise(count = n())

ggplot(backpack_weights) +
  aes(x = backpack_weight, y = count) +
  geom_col(fill = "seagreen") +
  scale_x_continuous(breaks = seq(2, 36, 2)) +
  scale_y_continuous(breaks = seq(2, 14, 2)) +
  labs(x = "Weight of backpack (kgs)", 
       y = "Number of students", 
       title = "Distribution of backpack weights being carried by students")
```




**Question 3.**
Are there differences in backpack weight between sex?

**Answer** 
Keeping in mind that there are 10 more females (n = 55) than males (n = 45), 
the total sum of backpack weights for females is higher than males: 607kg and 
559kg respectfully. 
The average weight for female's bags is 11kg, whereas male's bags are 12kg on 
average. 
We therefore do not see a great difference in bag weight between genders. 
```{r}
#just checking how many individuals are from each sex out of interest
backpack %>% 
  group_by(sex) %>% 
  summarise(count = n())
# 55 female, 45 male 

#Finding the mean backpack weight for each 
backpack %>% 
  group_by(sex) %>% 
  summarise(average_weight = round(mean(backpack_weight)))
# The average for each sex, round to the closest figure, is:
# Females = 11kg, Male = 12kg

backpack %>% 
  select(sex, backpack_weight) %>% 
  filter(sex == "Female") %>% 
  summarise(female_bags = sum(backpack_weight))
# Female's bags total weight is 607kg
backpack %>% 
  select(sex, backpack_weight) %>% 
  filter(sex == "Male") %>% 
  summarise(female_bags = sum(backpack_weight))
# Male's bags total weight is 559kg

#Total count for each 
ggplot(backpack) +
  aes(x = sex, y = backpack_weight, fill = sex) +
  geom_col() +
#  geom_text(aes(label = backpack_weight),             
 #          color = "black", size = 4, hjust = 0)+
  labs(x = "Sex",
       y = "Total backpack weight (kgs)", 
       title = "Total backpack weight by gender", 
       fill = "Sex")

```


**Question 4.**
What is the relationship between body weight and backpack weight?

**Answer**
From looking at the scatter plot, there does not appear to be a very clear 
relationship between body weight and backback weight. However, there might be a 
slight argument for an increase in one relating to an increase in the other 
which could be checked with statistical tests. 

```{r}
backpack
ggplot(backpack)+
  aes(x = body_weight, y = backpack_weight) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Body weight (lbs)", 
       y = "Backpack weight (kgs)", 
       title = "The relationship between body weight and backpack weight")

```


**Question 5.**
Is this relationship different between men and women? Choose an appropriate 
plot and interpret your findings.

**Answer**
I would not argue that the relationship between body weight and backpack weight 
is different between sexes.
Again however, there might be a slight argument for an increase in one relating 
to an increase in the other which could be checked with statistical tests. 

```{r}
backpack
ggplot(backpack)+
  aes(x = body_weight, y = backpack_weight, colour = sex) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)+
  labs(x = "Body weight (lbs)", 
       y = "Backpack weight (kgs)",
       colour = "Sex",
       title = "The relationship between body weight and backpack weight")

```


**Question 6.**
What proportion of students report back pain?

**Answer** 
Just less than 1/3 of students (32%) report to have back problems 
and slightly over 2/3 (68%) of students do not report back problems.
```{r}
backpack %>% 
  group_by(back_problems) %>% 
  summarise(count = n()) %>% 
  mutate(frequencey = formattable::percent(count / sum(count)))
# 32% of students report back problems, 68% do not.
  

backpain <- ggplot(backpack) +
  aes(x = back_problems) + # fill = back_problems - didn't work
  geom_bar() +
  coord_flip() +
  scale_y_continuous(breaks = seq(0, 100, 20), 
                     limits = c(0, 100)) +
  scale_fill_manual(values = c("coral", "seagreen"), # this didn't work
                   name = "",
                   labels = c("No back pain", "Back pain")) +
  labs(x = "No back problems - Vs - Back problems",
       y = "Number of students",
       title = "Proportion of students reporting backpain")
backpain
# ^ This is ugly
# Note that filling with colour didn't work... I need to change the 0 and 1 to 
# "No problems" and "Problems" as well. 


# Just practicing... this outcome was not what I was hoping for:
pie <- backpain + coord_polar("y", start = 0) +
  scale_fill_brewer(palette = "Dark2")
pie
```


**Question 7.**
Is this proportion different between men and women?

**Answer**
Yes. Women have much closer results with 44% (n = 24) reporting back problems 
and 56% (n = 31) reporting no pain. Only 18% (n = 8) of men reported back 
problems with 82% (n = 37) of men reporting to have none. 

(Not happy with this chart especially as I still need to change the backpain
values)
```{r}
backpain_and_gender <- backpack %>% 
  group_by(sex, back_problems) %>% 
  summarise(count = n()) %>% 
  mutate(frequencey = formattable::percent(count / sum(count)))
backpain_and_gender 


ggplot(backpack) +
  aes(x = back_problems, fill = sex) +
  geom_bar() +
  coord_flip() +
  scale_y_continuous(breaks = seq(0, 100, 20), 
                     limits = c(0, 100)) +
  labs(x = "No back problems - Vs - Back problems",
       y = "Number of students",
       title = "Proportion of students reporting backpain")
```

**Question 8.**
Now youâ€™ve investigated your data separately, create plots to describe the 
relationship between backpack weight, body weight, gender and reported backpain.

Try both backpack_weight and body_weight as well as the ratio.

Hint: faceting would be useful here.

**Answer**
(I really am not sure what to do with the ratio here)

```{r}

ggplot(backpack) +
  aes(x = body_weight, y = backpack_weight, group = sex, colour = sex) +
  geom_point(show.legend = FALSE) +
  geom_smooth(method = "lm", se = FALSE)+
  facet_wrap(back_problems~sex, labeller = "label_both") +
  labs(x = "Body weight (lbs)", 
       y = "Backpack weight (kgs)", 
       title = "Relationships between body weight, backpack weight, gender, and 
       backpain" )
```



